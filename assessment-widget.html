<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPARK AI Talent Assessment</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* A little extra CSS for a "form-in-progress" look */
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #3b82f6; /* Blue */
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-slate-900 font-sans flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-white dark:bg-slate-800 shadow-md border-b-4 border-indigo-600 dark:border-indigo-500 sticky top-0 z-10">
        <div class="container mx-auto max-w-4xl px-4 py-6">
            <h1 class="text-5xl font-extrabold text-indigo-600 dark:text-indigo-400 tracking-tight">
                SPARK AI Talent Assessment
            </h1>
            <p class="text-lg text-gray-700 dark:text-slate-300 mt-2">Please complete the assessment below to begin the AI analysis.</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto max-w-4xl p-4 lg:p-8 flex-grow">
        
        <!-- Main Assessment Form Card -->
        <section id="submit-section" class="bg-white dark:bg-slate-800 dark:border dark:border-slate-700 rounded-xl shadow-2xl overflow-hidden transition-all duration-300">
            
            <!-- Card Header -->
            <header class="p-6 border-b border-gray-200 dark:border-slate-700 flex items-center space-x-3">
                <svg class="h-8 w-8 text-indigo-600 dark:text-indigo-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                </svg>
                <h2 class="text-2xl font-semibold text-gray-900 dark:text-white">New Candidate Assessment</h2>
            </header>
            
            <!-- This is the custom HTML form -->
            <form id="assessment-form" class="p-6">
                
                <!-- This message area is hidden by default -->
                <div id="message-area" class="hidden mb-6 p-4 rounded-md"></div>

                <!-- 
                  !!! IMPORTANT !!!
                  You must create a <div class="mb-6">...</div> block for ALL 97 of your questions.
                  The "id" and "name" must be unique for each.
                  The "name" attribute MUST match the column header in your 'Form Responses' sheet (e.g., B1:CS1)
                -->

                <!-- Example: Text Input (Name) - Assumes header in B1 is "Candidate Name" -->
                <div class="mb-6">
                    <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Candidate Name</label>
                    <input type="text" id="name" name="Candidate Name" required class="block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-700 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                </div>
                
                <!-- Example: Text Input (Email) - Assumes header in C1 is "Candidate Email" -->
                <div class="mb-6">
                    <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Candidate Email</label>
                    <input type="email" id="email" name="Candidate Email" required class="block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-700 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                </div>
                
                <!-- ... YOU MUST ADD ALL YOUR OTHER QUESTIONS HERE ... -->


                <!-- Submit Button -->
                <div class="mt-8 border-t border-gray-200 dark:border-gray-700 pt-6">
                    <button id="submit-button" type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-indigo-500 dark:hover:bg-indigo-600">
                        Submit Assessment
                    </button>
                    <!-- Loading indicator, hidden by default -->
                    <div id="loader" class="hidden w-full flex justify-center py-3">
                        <div class="loader"></div>
                    </div>
                </div>

            </form>
        </section>
    </main>

    <!-- Footer -->
    <footer class="text-center py-6 text-gray-500 dark:text-gray-400 text-sm">
        <p>&copy; 2024 SPARK AI Assessments. All rights reserved.</p>
        <p class="mt-1">You will receive your results via email after manager review.</p>
    </footer>

    <!-- JavaScript for form submission -->
    <script>
        const form = document.getElementById('assessment-form');
        const submitButton = document.getElementById('submit-button');
        const loader = document.getElementById('loader');
        const messageArea = document.getElementById('message-area');

        // --- !!! CRITICAL: PASTE YOUR WEB APP URL HERE !!! ---
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwEOIBwq4Dr1MwJiNkGeQ1xjHK6qkwA-8OYvGTLIFB20SPF2qdga3xe1I7NEV3z3o8S/exec';
        // --- !!! --------------------------------------- ---

        form.addEventListener('submit', async (e) => {
            e.preventDefault(); // Stop the form from submitting normally
            submitButton.classList.add('hidden');
            loader.classList.remove('hidden');
            messageArea.classList.add('hidden');

            const formData = new FormData(form);
            const data = {};
            formData.forEach((value, key) => { data[key] = value; });

            try {
                // We use a "ping" method. We send the data, but don't wait for a response.
                // This is the most reliable way to submit from a browser to Apps Script
                // without complex CORS issues.
                navigator.sendBeacon(WEB_APP_URL, JSON.stringify(data));

                // Since sendBeacon doesn't report success/failure, we'll just assume success
                // and show the confirmation message immediately after a short delay.
                setTimeout(() => {
                    form.classList.add('hidden');
                    loader.classList.add('hidden');
                    
                    messageArea.classList.remove('hidden');
                    messageArea.classList.add('bg-green-100', 'text-green-800', 'dark:bg-green-800', 'dark:text-green-100');
                    messageArea.innerText = 'Success! Your assessment has been submitted for analysis. You may now close this window.';
                }, 1500); // 1.5 second delay to feel like it's processing

            } catch (error) {
                // This catch block will rarely run with sendBeacon, but it's good practice.
                messageArea.classList.remove('hidden');
                messageArea.classList.add('bg-red-100', 'text-red-800', 'dark:bg-red-800', 'dark:text-red-100');
                messageArea.innerText = 'Error: Could not submit assessment. Please try again later. ' + error.message;

                submitButton.classList.remove('hidden');
                loader.classList.add('hidden');
            }
        });
    </script>

</body>
</html>